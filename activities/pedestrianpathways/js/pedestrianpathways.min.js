function AudioChannel(t,e){this.scene=t,this.audioSprite=e,this.delayTimer=null,this.event=null,this.key=e.key,this.play=function(t,e,i){t.key==this.key?t.delay?this.delayedPlay(t.sprite,t.config,t.delay,e,i):this.playNow(t.sprite,t.config,e,i):console.log("Sound data must be from same AudioSprite. "+t.key+" != "+this.key)},this.stop=function(){this.audioSprite.stop(),this.clearDelayTimer(),this.cancelOnComplete()},this.getTime=function(){return this.audioSprite.seek},this.getMarker=function(){return this.audioSprite.currentMarker.name},this.clearDelayedSounds=function(){this.clearDelayTimer()},this.playNow=function(t,e,i,s){this.stop(),this.audioSprite.play(t,e),this.clearDelayTimer(),i&&(this.event=this.audioSprite.once("complete",i,s))},this.delayedPlay=function(t,e,i,s,o){this.delayTimer=this.scene.time.delayedCall(i,this.playNow,[t,e,s,o],this)},this.clearDelayTimer=function(){null!=this.delayTimer&&(this.delayTimer.destroy(),this.delayTimer=null)},this.cancelOnComplete=function(){this.event&&this.event.removeAllListeners()}}function TextButton(e,t,i,s,o,n){this.config=e,this.context=t,this.upCallback=i,this.downCallback=s,this.overCallback=o,this.outCallback=n,this.data={},this.hitArea=null,this.hitAreaType=null,this.image=null,this.text=null,this.image=t.add.image(e.x,e.y,e.graphic.texture,e.graphic.up),e.text&&(this.text=t.add.text(e.x+e.text.xOffset,e.y+e.text.yOffset,e.text.label,e.text.upStyle),this.text.setOrigin(.5,.5)),e.flipX&&(this.image.flipX=!0),e.depth&&(this.image.depth=e.depth),e.hitArea&&"rect"==e.hitArea.type&&(this.hitAreaType=e.hitArea.type,this.hitArea=new Phaser.Geom.Rectangle(e.hitArea.x,e.hitArea.y,e.hitArea.width,e.hitArea.height)),this.enable=function(){null!=this.hitArea?"rect"==this.hitAreaType&&(this.image.removeInteractive(),this.image.setInteractive(this.hitArea,this.checkHitRect)):this.image.setInteractive(),0==this.image.listenerCount("pointerdown")&&this.image.on("pointerdown",this.onDown,this),0==this.image.listenerCount("pointerup")&&this.image.on("pointerup",this.onUp,this),0==this.image.listenerCount("pointerover")&&this.image.on("pointerover",this.onOver,this),0==this.image.listenerCount("pointerout")&&this.image.on("pointerout",this.onOut,this),this.config.graphic.disabled&&this.image.setFrame(this.config.graphic.up)},this.disable=function(t=!0){this.image.disableInteractive(),this.image.removeListener("pointerdown",this.onDown,this),this.image.removeListener("pointerup",this.onUp,this),this.image.removeListener("pointerover",this.onOver,this),this.image.removeListener("pointerout",this.onOut,this),this.config.graphic.disabled&&t&&this.image.setFrame(this.config.graphic.disabled)},this.setVisible=function(t){this.image.visible=t,this.text&&(this.text.visible=t)},this.setHighlight=function(t){this.config.graphic.highlight&&(1==t?this.image.setFrame(this.config.graphic.highlight):this.image.setFrame(this.config.graphic.up))},this.getImage=function(){return this.image},this.getVisuals=function(){var t=[this.image];return this.text&&t.push(this.text),t},this.setX=function(t){this.image.x=t,this.text&&(this.text.x=this.image.x+e.text.xOffset)},this.getX=function(){return this.image.x},this.setY=function(t){this.image.y=t,this.text&&(this.text.y=this.image.y+e.text.yOffset)},this.adjustY=function(t){this.image.y+=t,this.text&&(this.text.y=this.image.y+e.text.yOffset)},this.getY=function(){return this.image.y},this.setText=function(t){this.text&&(this.text.text=t)},this.setDepth=function(t){this.image.setDepth(t),this.text&&this.text.setDepth(t+1)},this.onDown=function(){this.image.setFrame(this.config.graphic.down),this.text&&this.text.setStyle(this.config.text.downStyle),this.downCallback&&this.downCallback.call(this.context,this)},this.onOver=function(){this.image.setFrame(this.config.graphic.over),this.text&&this.text.setStyle(this.config.text.overStyle),this.overCallback&&this.overCallback.call(this.context,this)},this.onUp=function(){this.showUp(),this.upCallback&&this.upCallback.call(this.context,this)},this.onOut=function(){this.image.setFrame(this.config.graphic.up),this.text&&this.text.setStyle(this.config.text.upStyle),this.outCallback&&this.outCallback.call(this.context,this)},this.showSelected=function(){this.image.setFrame(this.config.graphic.selected),this.text&&this.text.setStyle(this.config.text.selectedStyle)},this.showUp=function(){this.image.setFrame(this.config.graphic.up),this.text&&this.text.setStyle(this.config.text.upStyle)},this.destroy=function(){this.disable(),this.image.destroy(),this.text&&this.text.destroy()},this.checkHitRect=function(t,e,i,s){return e>=t.x&&e<=t.x+t.width&&i>=t.y&&i<=t.y+t.height},this.setHitArea=function(t,e){"rect"==t&&(this.hitAreaType=t,this.hitArea=new Phaser.Geom.Rectangle(e.x,e.y,e.width,e.height))},this.enable()}!function(){function t(){var t=document.querySelector("canvas"),e=window.innerWidth,i=window.innerHeight,s=gSettings.gameConfig.width/gSettings.gameConfig.height;e/i<s?(t.style.width=e+"px",t.style.height=e/s+"px"):(t.style.width=i*s+"px",t.style.height=i+"px")}window.onload=function(){gSettings.autoScale&&(window.focus(),t(),window.addEventListener("resize",t)),gSettings.gameConfig.scene=[Boot,Clickthrough,Preload,GameBase,Splash,Map,Dialog,Status,Question,Win],gSettings.gameConfig.canvas=document.getElementById("game"),gSettings.gameConfig.type=Phaser.CANVAS,new Phaser.Game(gSettings.gameConfig)}}();var Boot=new Phaser.Scene("Boot");Boot.preload=function(){this.load.image(gSettings.loader.rotator.key,gSettings.loader.rotator.file);for(var t=0;t<gSettings.loader.backgroundElements.length;t++)this.load.image(gSettings.loader.backgroundElements[t].key,gSettings.loader.backgroundElements[t].file)},Boot.create=function(){var t=!0;(t=gSettings.scormEnabled?SCORM_API_adapter.lmsInitialize():t)?this.scene.start("Clickthrough"):alert("Unable to initialize SCORM API. Re-start course to try again.")};var Clickthrough=new Phaser.Scene("Clickthrough");Clickthrough.preload=function(){},Clickthrough.create=function(){this.addLoader(),this.input.on("pointerup",this.continue,this)},Clickthrough.addLoader=function(){for(var t=0;t<gSettings.loader.backgroundElements.length;t++)this.add.sprite(gSettings.loader.backgroundElements[t].x,gSettings.loader.backgroundElements[t].y,gSettings.loader.backgroundElements[t].key);this.add.text(gSettings.loader.clickthroughText.x,gSettings.loader.clickthroughText.y,gSettings.loader.clickthroughText.text,gSettings.loader.clickthroughText.style).setOrigin(gSettings.loader.clickthroughText.origin.x,gSettings.loader.clickthroughText.origin.y)},Clickthrough.continue=function(){this.scene.start("Preload")};var Dialog=new Phaser.Scene("Dialog");Dialog.READY="ready",Dialog.SHOW_COMPLETE="show-complete",Dialog.HIDE_COMPLETE="hide-complete",Dialog.STATE_COMPLETE="state-complete",Dialog.init=function(){this.box=null,this.text=null,this.closeButton=null,this.replayButton=null,this.pointer=null,this.currentStateData=null,this.active=!1,this.voTimer=null,this.status="idle",this.tween=null,this.reopen=!1},Dialog.preload=function(){},Dialog.create=function(){this.baseScene=this.scene.get("GameBase"),this.box=this.baseScene.addImage(gSettings.dialog.box,this),this.text=this.baseScene.addText(gSettings.dialog.text,this),this.closeButton=new TextButton(gSettings.dialog.closeButton,this,this.handleClose),this.replayButton=new TextButton(gSettings.dialog.replayButton,this,this.handleReplay),this.hide(!0),this.events.emit(this.READY)},Dialog.update=function(){console.log("status: "+this.status)},Dialog.hide=function(t=!1,e=!1){(this.isShowing()||e)&&(t?(this.box.x+=gSettings.dialog.hidePositionOffset.x,this.box.y+=gSettings.dialog.hidePositionOffset.y,this.text.x+=gSettings.dialog.hidePositionOffset.x,this.text.y+=gSettings.dialog.hidePositionOffset.y,this.closeButton.setX(this.closeButton.getX()+gSettings.dialog.hidePositionOffset.x),this.closeButton.setY(this.closeButton.getY()+gSettings.dialog.hidePositionOffset.y),this.replayButton.setX(this.replayButton.getX()+gSettings.dialog.hidePositionOffset.x),this.replayButton.setY(this.replayButton.getY()+gSettings.dialog.hidePositionOffset.y),this.status="closed",this.handleHideComplete()):(this.tween=this.tweens.add({targets:[this.box,this.text,this.closeButton.getImage(),this.replayButton.getImage()],x:"+="+gSettings.dialog.hidePositionOffset.x,y:"+="+gSettings.dialog.hidePositionOffset.y,duration:gSettings.dialog.hideAnimation.duration,ease:gSettings.dialog.hideAnimation.ease,onComplete:this.handleHideComplete,onCompleteScope:this}),this.status="closing"),this.stopVo())},Dialog.show=function(t=!1){this.isHidden()&&(t?(this.box.x=gSettings.dialog.box.x,this.box.y=gSettings.dialog.box.y,this.text.x=gSettings.dialog.text.x,this.text.y=gSettings.dialog.text.y,this.closeButton.setX(gSettings.dialog.closeButton.x),this.closeButton.setY(gSettings.dialog.closeButton.y),this.replayButton.setX(gSettings.dialog.replayButton.x),this.replayButton.setY(gSettings.dialog.replayButton.y),this.status="open-idle",this.handleShowComplete()):(this.tween=this.tweens.add({targets:[this.box,this.text,this.closeButton.getImage(),this.replayButton.getImage()],x:"-="+gSettings.dialog.hidePositionOffset.x,y:"-="+gSettings.dialog.hidePositionOffset.y,duration:gSettings.dialog.showAnimation.duration,ease:gSettings.dialog.showAnimation.ease,onComplete:this.handleShowComplete,onCompleteScope:this}),this.status="opening"))},Dialog.isHidden=function(){return this.box.x==gSettings.dialog.box.x+gSettings.dialog.hidePositionOffset.x&&this.box.y==gSettings.dialog.box.y+gSettings.dialog.hidePositionOffset.y},Dialog.isShowing=function(){return this.box.x==gSettings.dialog.box.x&&this.box.y==gSettings.dialog.box.y},Dialog.handleShowComplete=function(){this.events.emit(this.SHOW_COMPLETE),this.playVo()},Dialog.handleHideComplete=function(){this.status="closed",this.reopen?(this.show(),this.reopen=!1):this.events.emit(this.HIDE_COMPLETE)},Dialog.handleClose=function(){},Dialog.handleReplay=function(){},Dialog.playVo=function(){this.status="open-playing",this.voTimer=this.time.delayedCall(3e3,this.handleVoComplete,[],this)},Dialog.stopVo=function(){this.voTimer&&this.voTimer.remove(),this.active=!1},Dialog.handleVoComplete=function(){null==this.currentStateData.nextState?(this.active=!1,this.status="open-idle",this.events.emit(this.STATE_COMPLETE)):this.setState(this.currentStateData.nextState)},Dialog.setState=function(e){console.log("state -> "+e),console.log("status = "+this.status),this.active=!0;for(let t=0;t<gSettings.dialog.states.length;t++)if(gSettings.dialog.states[t].id==e){this.currentStateData=gSettings.dialog.states[t];break}switch(this.closeButton.setVisible(this.currentStateData.showCloseButton),this.replayButton.setVisible(this.currentStateData.showReplayButton),this.text.text=this.currentStateData.text,this.status){case"open-idle":case"open-playing":this.playVo();break;case"closed":this.show();break;case"opening":break;case"closing":this.reopen=!0,this.hide(!0,!0)}},(Dialog=new Phaser.Scene("Dialog")).READY="ready",Dialog.MESSAGE_END="message-end",Dialog.init=function(){this.box=null,this.text=null,this.closeButton=null,this.replayButton=null,this.pointer=null,this.messageQueue=[],this.currentMessageId=null,this.tween=null,this.isClosing=!1},Dialog.preload=function(){},Dialog.create=function(){this.baseScene=this.scene.get("GameBase"),this.box=this.baseScene.addImage(gSettings.dialog.box,this),this.box.x+=gSettings.dialog.closePositionOffset.x,this.box.y+=gSettings.dialog.closePositionOffset.y,this.text=this.baseScene.addText(gSettings.dialog.text,this),this.text.x+=gSettings.dialog.closePositionOffset.x,this.text.y+=gSettings.dialog.closePositionOffset.y,this.events.emit(this.READY)},Dialog.update=function(){},Dialog.addToQueue=function(t){var e=this.getMessageData(t);null==e?console.log("ERROR: Message ID '"+t+"' not found"):(this.messageQueue.push(t),1!=this.messageQueue.length||this.isClosing||this.startNextMessage(),null!=e.nextMessage&&this.addToQueue(e.nextMessage))},Dialog.getMessageData=function(e){var i=null;for(let t=0;t<gSettings.dialog.messages.length;t++)if(e==gSettings.dialog.messages[t].id){i=gSettings.dialog.messages[t];break}return i},Dialog.startNextMessage=function(){var t;0!=this.messageQueue.length&&(this.currentMessageId=this.messageQueue[0],t=this.getMessageData(this.currentMessageId),this.text.text=t.text,this.isClosed()?this.openMessage():this.playVo())},Dialog.isClosed=function(){return this.box.x==gSettings.dialog.box.x+gSettings.dialog.closePositionOffset.x&&this.box.y==gSettings.dialog.box.y+gSettings.dialog.closePositionOffset.y},Dialog.openMessage=function(){this.tween=this.tweens.add({targets:[this.box,this.text],x:"-="+gSettings.dialog.closePositionOffset.x,y:"-="+gSettings.dialog.closePositionOffset.y,duration:gSettings.dialog.openAnimation.duration,ease:gSettings.dialog.openAnimation.ease,onComplete:this.handleOpenMessageComplete,onCompleteScope:this})},Dialog.handleOpenMessageComplete=function(){this.playVo()},Dialog.playVo=function(){var t=this.getMessageData(this.currentMessageId);this.baseScene.playVo(t.vo,this.handleVoComplete,this)},Dialog.stopVo=function(){this.baseScene.stopVo()},Dialog.handleVoComplete=function(){this.messageQueue.splice(0,1),this.events.emit(this.MESSAGE_END),0<this.messageQueue.length?this.startNextMessage():this.currentMessageId=null},Dialog.clear=function(){this.isClosed()||(this.messageQueue=[],this.currentMessageId=null,this.stopVo(),this.closeMessage())},Dialog.closeMessage=function(){this.isClosing=!0,this.tween=this.tweens.add({targets:[this.box,this.text],x:"+="+gSettings.dialog.closePositionOffset.x,y:"+="+gSettings.dialog.closePositionOffset.y,duration:gSettings.dialog.closeAnimation.duration,ease:gSettings.dialog.closeAnimation.ease,onComplete:this.handleCloseMessageComplete,onCompleteScope:this})},Dialog.handleCloseMessageComplete=function(){this.isClosing=!1,this.startNextMessage()};var GameBase=new Phaser.Scene("GameBase");GameBase.init=function(t){this.voChannel=new AudioChannel(this,t.voSprite),this.sfxChannel=new AudioChannel(this,t.sfxSprite),this.loopChannel=new AudioChannel(this,t.loopSprite),this.splash=null,this.map=null,this.status=null,this.question=null,this.questionCount=0,this.dialog=null,this.itemsCollected=0,this.allItemsCollected=!1,this.questionPool=[]},GameBase.preload=function(){},GameBase.create=function(){gSettings.scormEnabled&&SCORM_API_adapter.markComplete(),this.addSplash()},GameBase.addSplash=function(){this.scene.launch("Splash"),this.splash=this.scene.get("Splash"),this.splash.events.on(this.splash.CONTINUE,this.removeSplash,this),this.startMusic()},GameBase.removeSplash=function(){this.stopLoop(),this.scene.sleep("Splash"),this.addMap(),this.addDialog(),this.addStatus(),this.time.delayedCall(500,this.startInstructions,[],this),gSettings.scormEnabled&&SCORM_API_adapter.markComplete()},GameBase.startMusic=function(){this.playLoop(gSettings.sounds.musicLoop)},GameBase.addMap=function(){null==this.map?(this.scene.launch("Map"),this.map=this.scene.get("Map"),this.map.events.on(this.map.QUESTION,this.handleMapQuestion,this),this.map.events.on(this.map.PLAYER_MOVE,this.handleMapPlayerMove,this),this.map.events.on(this.map.ITEM_COLLECTED,this.handleMapItemCollected,this),this.map.events.on(this.map.GOAL_COLLISION,this.handleMapGoalCollision,this)):this.scene.wake("Map")},GameBase.handleMapPlayerMove=function(){this.clearDialog()},GameBase.handleMapQuestion=function(){this.playSfx(gSettings.sounds.questionPrompt,this.showQuestionPrompt,this)},GameBase.showQuestionPrompt=function(){this.dialog.addToQueue("question-prompt"),this.dialog.events.once(this.dialog.MESSAGE_END,this.handleMapQuestionDialogMessageEnd,this)},GameBase.handleMapQuestionDialogMessageEnd=function(){this.addQuestion(),this.clearDialog()},GameBase.handleMapItemCollected=function(){var e=this.map.getLastItemIdCollected(),i=null;for(let t=0;t<gSettings.map.items.length;t++)if(gSettings.map.items[t].id==e){i=gSettings.map.items[t].messageId;break}this.playSfx(gSettings.sounds.itemPickup),this.time.delayedCall(250,this.dialog.addToQueue,[i],this.dialog),this.status.earnItem(e)},GameBase.handleMapGoalCollision=function(){this.status.allItemsCollected()&&(this.map.pausePlayer(),this.map.handleWin(),this.playSfx(gSettings.sounds.win),this.time.delayedCall(1500,this.addWin,[],this))},GameBase.addStatus=function(){null==this.status?(this.scene.launch("Status"),this.status=this.scene.get("Status"),this.status.events.on(this.status.ALL_ITEMS_COLLECTED,this.handleAllItemsCollected,this)):this.scene.wake("Status")},GameBase.handleAllItemsCollected=function(){this.time.delayedCall(300,this.dialog.addToQueue,["all-items-collected"],this.dialog)},GameBase.addQuestion=function(){this.questionCount++,null==this.question?(this.scene.launch("Question"),this.question=this.scene.get("Question"),this.question.events.on(this.question.CREATED,this.handleQuestionCreated,this),this.question.events.on(this.question.CORRECT_ANSWER,this.handleQuestionCorrect,this),this.question.events.on(this.question.INCORRECT_ANSWER,this.handleQuestionIncorrect,this),this.question.events.on(this.question.CONTINUE,this.handleQuestionContinue,this)):(this.scene.wake("Question"),this.question.loadQuestion(this.getNextQuestionIndex(),this.sectionIndex))},GameBase.handleQuestionCreated=function(){this.scene.wake("Question"),this.question.loadQuestion(this.getNextQuestionIndex(),this.sectionIndex)},GameBase.handleQuestionCorrect=function(){},GameBase.handleQuestionIncorrect=function(){},GameBase.handleQuestionContinue=function(){this.scene.sleep("Question"),this.question.isCorrect?this.time.delayedCall(500,this.map.handleCorrectAnswer,[],this.map):this.time.delayedCall(500,this.map.handleIncorrectAnswer,[],this.map)},GameBase.resetQuestionPool=function(){for(var t=0;t<gSettings.question.questions.length;t++)this.questionPool.push(t)},GameBase.getNextQuestionIndex=function(){0==this.questionPool.length&&this.resetQuestionPool();var t=0;return gSettings.randomizeQuestions&&(t=Math.floor(Math.random()*this.questionPool.length)),this.questionPool.splice(t,1)[0]},GameBase.addDialog=function(){null==this.dialog?(this.scene.launch("Dialog"),this.dialog=this.scene.get("Dialog")):this.scene.wake("Dialog")},GameBase.clearDialog=function(){this.dialog.clear(),this.dialog.events.removeAllListeners(Dialog.MESSAGE_END)},GameBase.startInstructions=function(){this.dialog.addToQueue("instructions")},GameBase.addWin=function(){null==this.win?(this.scene.launch("Win"),this.win=this.scene.get("Win"),this.win.events.on(this.win.PLAY_AGAIN,this.handlePlayAgain,this)):this.scene.wake("Win")},GameBase.handlePlayAgain=function(){this.removeWin(),this.resetGame()},GameBase.removeWin=function(){this.scene.sleep("Win")},GameBase.resetGame=function(){this.map.resetMap(),this.dialog.clear(),this.status.resetStatus(),this.time.delayedCall(500,this.startInstructions,[],this)},GameBase.addBackgroundItems=function(t,e){for(var i=[],s=0;s<t.length;s++)"image"===t[s].type&&i.push(this.addImage(t[s],e));return i},GameBase.addImage=function(t,e){e=e.add.image(t.x,t.y,t.texture,t.frame);return t.flipX&&(e.flipX=!0),t.scaleX&&(e.scaleX=t.scaleX),t.scaleY&&(e.scaleY=t.scaleY),t.scale&&(e.scaleX=e.scaleY=t.scale),t.depth&&(e.depth=t.depth),null!=t.scrollFactor&&e.setScrollFactor(t.scrollFactor),t.origin&&e.setOrigin(t.origin.x,t.origin.y),e},GameBase.addText=function(t,e){e=e.add.text(t.x,t.y,t.text,t.style);return e.setOrigin(t.origin.x,t.origin.y),e},GameBase.playVo=function(t,e,i){this.voChannel.play(t,e,i)},GameBase.playSfx=function(t,e,i){this.sfxChannel.play(t,e,i)},GameBase.playLoop=function(t,e,i){this.loopChannel.play(t,e,i)},GameBase.stopVo=function(){this.voChannel.stop()},GameBase.stopSfx=function(){this.sfxChannel.stop()},GameBase.stopLoop=function(){this.loopChannel.stop()};var Map=new Phaser.Scene("Map");Map.PLAYER_MOVE="player-move",Map.CONTINUE="continue",Map.QUESTION="question",Map.ITEM_COLLECTED="item-collected",Map.GOAL_COLLISION="goal-collision",Map.init=function(){this.upArrowButton=null,this.rightArrowButton=null,this.downArrowButton=null,this.leftArrowButton=null,this.currentLocationId=null,this.questionAttemptDirection=null,this.lastItemIdCollected=null,this.disabledCrosswalk={locationId:null,direction:null},this.crosswalkClosedSign=null,this.playerTween=null,this.stopPoints=[],this.items=[],this.goal=null,this.player=null,this.itemsCollected=0},Map.preload=function(){},Map.create=function(){this.baseScene=this.scene.get("GameBase"),this.baseScene.addBackgroundItems(gSettings.map.backgroundItems,this),this.addStopPoints();var t=this.addItems();this.addGoal(t);t=this.addPlayer();this.addArrowButtons(t)},Map.update=function(){},Map.addStopPoints=function(){for(let e=0;e<gSettings.map.locations.length;e++)if("stop"==gSettings.map.locations[e].type){let t={x:0,y:0};t.x=gSettings.map.locations[e].point.x,t.y=gSettings.map.locations[e].point.y,this.stopPoints.push(t)}},Map.addItems=function(){var e=gSettings.map.items.length,i=[];for(let t=0;t<gSettings.map.itemLocations.length;t++)i.push(t);for(let t=0;t<e;t++){var s=i.splice(Math.floor(Math.random()*i.length),1)[0],o=gSettings.map.itemLocations[s],s=Math.floor(Math.random()*o.points.length),o=o.points[s],s=this.baseScene.addImage(gSettings.map.items[t].image,this);s.x=o.x,s.y=o.y,s.setData("id",gSettings.map.items[t].id),this.items.push(s)}return i},Map.addGoal=function(t){var e=t.splice(Math.floor(Math.random()*(t.length-1)),1)[0],t=gSettings.map.itemLocations[e],e=Math.floor(Math.random()*t.points.length),e=t.points[e];this.goal=this.baseScene.addImage(gSettings.map.goal.image,this),this.goal.x=e.x,this.goal.y=e.y},Map.addPlayer=function(){this.player=this.baseScene.addImage(gSettings.map.player.image,this);var t=this.getStartLocationData();return this.player.x=t.point.x,this.player.y=t.point.y,this.currentLocationId=t.id,t},Map.getStartLocationData=function(){var e=null;for(let t=0;t<gSettings.map.locations.length;t++)if("start"==gSettings.map.locations[t].type){e=gSettings.map.locations[t];break}return e},Map.addArrowButtons=function(t){null==this.upArrowButton&&(this.upArrowButton=new TextButton(gSettings.map.upButton,this,this.handleArrowClick),this.upArrowButton.data.direction="up",this.rightArrowButton=new TextButton(gSettings.map.rightButton,this,this.handleArrowClick),this.rightArrowButton.data.direction="right",this.downArrowButton=new TextButton(gSettings.map.downButton,this,this.handleArrowClick),this.downArrowButton.data.direction="down",this.leftArrowButton=new TextButton(gSettings.map.leftButton,this,this.handleArrowClick),this.leftArrowButton.data.direction="left"),this.positionArrowButton(this.upArrowButton,gSettings.map.upButton),null==t.up||t.id==this.disabledCrosswalk.locationId&&"up"==this.disabledCrosswalk.direction?this.upArrowButton.setVisible(!1):this.upArrowButton.setVisible(!0),this.positionArrowButton(this.rightArrowButton,gSettings.map.rightButton),null==t.right||t.id==this.disabledCrosswalk.locationId&&"right"==this.disabledCrosswalk.direction?this.rightArrowButton.setVisible(!1):this.rightArrowButton.setVisible(!0),this.positionArrowButton(this.downArrowButton,gSettings.map.downButton),null==t.down||t.id==this.disabledCrosswalk.locationId&&"down"==this.disabledCrosswalk.direction?this.downArrowButton.setVisible(!1):this.downArrowButton.setVisible(!0),this.positionArrowButton(this.leftArrowButton,gSettings.map.leftButton),null==t.left||t.id==this.disabledCrosswalk.locationId&&"left"==this.disabledCrosswalk.direction?this.leftArrowButton.setVisible(!1):this.leftArrowButton.setVisible(!0)},Map.positionArrowButton=function(t,e){t.setX(this.player.x+e.x),t.setY(this.player.y+e.y)},Map.hideArrowButtons=function(){this.upArrowButton.setVisible(!1),this.rightArrowButton.setVisible(!1),this.downArrowButton.setVisible(!1),this.leftArrowButton.setVisible(!1)},Map.handleArrowClick=function(t){this.hideArrowButtons();t=t.data.direction;this.getLocationDataById(this.currentLocationId)[t].question?(this.questionAttemptDirection=t,this.clearDisabledCrosswalk(),this.events.emit(this.QUESTION)):(this.events.emit(this.PLAYER_MOVE),this.movePlayer(t))},Map.getLocationDataById=function(e){var i=null;for(let t=0;t<gSettings.map.locations.length;t++)if(gSettings.map.locations[t].id==e){i=gSettings.map.locations[t];break}return i},Map.movePlayer=function(t){var e=this.getLocationDataById(this.currentLocationId),i=e[t].path;this.playerTween=this.tweens.createTimeline();var s={x:e.point.x,y:e.point.y};for(let t=0;t<i.length;t++){var o=i[t],n=this.getLocationDataById(o),o=Phaser.Math.Distance.BetweenPoints(s,n.point);s.x=n.point.x,s.y=n.point.y;o=o/gSettings.map.player.speed*1e3;this.playerTween.add({targets:this.player,x:{value:n.point.x,duration:o,ease:"Linear"},y:{value:n.point.y,duration:o,ease:"Linear"},onStart:this.handlePlayerSegmentStart,onStartScope:this})}e=i[i.length-1];this.playerTween.setCallback("onComplete",this.handleMovePlayerComplete,[e],this),this.playerTween.setCallback("onUpdate",this.checkItemCollisions,[],this),this.playerTween.play(),this.setPlayerDirection(t),this.baseScene.playLoop(gSettings.sounds.walkLoop)},Map.setPlayerDirection=function(t){switch(t){case"up":this.player.setFrame(gSettings.map.player.up.frame);break;case"right":this.player.setFrame(gSettings.map.player.right.frame);break;case"down":this.player.setFrame(gSettings.map.player.down.frame);break;case"left":this.player.setFrame(gSettings.map.player.left.frame)}},Map.handlePlayerSegmentStart=function(e){var i=0,s=0,o=0,n=0;for(let t=0;t<e.data.length;t++)"x"==e.data[t].key?(i=Math.round(e.targets[0].x),s=e.data[t].getEndValue()):"y"==e.data[t].key&&(o=Math.round(e.targets[0].y),n=e.data[t].getEndValue());Math.abs(o-n)>Math.abs(i-s)?n<o?this.setPlayerDirection("up"):this.setPlayerDirection("down"):s<i?this.setPlayerDirection("left"):this.setPlayerDirection("right")},Map.handleMovePlayerComplete=function(t){this.baseScene.stopLoop(),this.currentLocationId=t,this.addArrowButtons(this.getLocationDataById(this.currentLocationId)),this.setPlayerDirection("down")},Map.pausePlayer=function(){this.playerTween.pause(),this.baseScene.stopLoop()},Map.checkItemCollisions=function(t){var e=this.player.getBounds();for(let t=0;t<this.items.length;t++){var i=this.items[t].getBounds();if(Phaser.Geom.Intersects.RectangleToRectangle(e,i)&&this.items[t].visible){this.collectItem(t);break}}var s=this.goal.getBounds();Phaser.Geom.Intersects.RectangleToRectangle(e,s)&&this.events.emit(this.GOAL_COLLISION)},Map.collectItem=function(t){this.items[t].visible=!1,this.itemsCollected++,this.lastItemIdCollected=this.items[t].getData("id"),this.events.emit(this.ITEM_COLLECTED)},Map.handleCorrectAnswer=function(){this.movePlayer(this.questionAttemptDirection)},Map.handleIncorrectAnswer=function(){this.disableCrosswalk(this.currentLocationId,this.questionAttemptDirection),this.addArrowButtons(this.getLocationDataById(this.currentLocationId))},Map.getLastItemIdCollected=function(){return this.lastItemIdCollected},Map.disableCrosswalk=function(t,e){this.disabledCrosswalk.locationId=t,this.disabledCrosswalk.direction=e,null==this.crosswalkClosedSign&&(this.crosswalkClosedSign=this.baseScene.addImage(gSettings.map.crosswalkClosed.image,this),this.crosswalkClosedSign.visible=!1);var i=this.getLocationDataById(t);switch(e){case"up":this.crosswalkClosedSign.x=i.point.x,this.crosswalkClosedSign.y=i.point.y-gSettings.map.crosswalkClosed.upOffset;break;case"right":this.crosswalkClosedSign.x=i.point.x+gSettings.map.crosswalkClosed.rightOffset,this.crosswalkClosedSign.y=i.point.y;break;case"down":this.crosswalkClosedSign.x=i.point.x,this.crosswalkClosedSign.y=i.point.y+gSettings.map.crosswalkClosed.downOffset;break;case"left":this.crosswalkClosedSign.x=i.point.x-gSettings.map.crosswalkClosed.leftOffset,this.crosswalkClosedSign.y=i.point.y}this.crosswalkClosedSign.visible=!0,this.baseScene.playSfx(gSettings.sounds.dontWalk)},Map.clearDisabledCrosswalk=function(){this.disabledCrosswalk.locationId=null,this.disabledCrosswalk.direction=null,this.crosswalkClosedSign&&(this.crosswalkClosedSign.visible=!1)},Map.handleWin=function(){this.goal.setFrame(gSettings.map.goal.winFrame)},Map.resetMap=function(){for(let t=0;t<this.stopPoints.length;t++)this.stopPoints[t]=null;this.stopPoints=[];for(let t=0;t<this.items.length;t++)this.items[t].destroy();this.items=[],this.goal.destroy(),this.goal=null,this.player.destroy(),this.player=null,this.itemsCollected=0,this.clearDisabledCrosswalk(),this.playerTween=null,this.addStopPoints();var t=this.addItems();this.addGoal(t);t=this.addPlayer();this.addArrowButtons(t)};var Preload=new Phaser.Scene("Preload");Preload.init=function(){},Preload.preload=function(){this.addLoader();for(var t=0;t<gSettings.spritesheets.length;t++)this.load.multiatlas(gSettings.spritesheets[t]);this.load.audioSprite(gSettings.voSprite),this.load.audioSprite(gSettings.sfxSprite),this.load.audioSprite(gSettings.loopSprite)},Preload.create=function(){this.rotatorTween.stop();var t=this.sound.addAudioSprite(gSettings.voSprite.key),e=this.sound.addAudioSprite(gSettings.sfxSprite.key),i=this.sound.addAudioSprite(gSettings.loopSprite.key);this.scene.start("GameBase",{voSprite:t,sfxSprite:e,loopSprite:i})},Preload.addLoader=function(){for(var t=0;t<gSettings.loader.backgroundElements.length;t++)this.add.sprite(gSettings.loader.backgroundElements[t].x,gSettings.loader.backgroundElements[t].y,gSettings.loader.backgroundElements[t].key);var e=this.add.sprite(gSettings.loader.rotator.x,gSettings.loader.rotator.y,gSettings.loader.rotator.key);this.rotatorTween=this.tweens.add({targets:e,angle:360,duration:gSettings.loader.rotator.rotationDuration,loop:-1}),this.add.text(gSettings.loader.loadingText.x,gSettings.loader.loadingText.y,gSettings.loader.loadingText.text,gSettings.loader.loadingText.style).setOrigin(gSettings.loader.loadingText.origin.x,gSettings.loader.loadingText.origin.y)};var Question=new Phaser.Scene("Question");Question.CORRECT="correct",Question.INCORRECT="incorrect",Question.CREATED="created",Question.CONTINUE="continue",Question.CORRECT_ANSWER="correct-answer",Question.INCORRECT_ANSWER="incorrect-answer",Question.init=function(){this.isCorrect=!1,this.continueButton=null,this.questionData=null,this.loadingMessage=null,this.questionText=null,this.options=[],this.remediationText=null},Question.preload=function(){},Question.create=function(){this.baseScene=this.scene.get("GameBase");var t=this.add.graphics();t.fillStyle(3650877,1),t.fillRect(0,0,800,600),this.baseScene.addBackgroundItems(gSettings.question.backgroundItems,this),this.continueButton=new TextButton(gSettings.question.continueButton,this,this.handleContinueClick),this.continueButton.setVisible(!1),this.events.emit(this.CREATED)},Question.handleContinueClick=function(){this.cleanUp(),this.events.emit(this.CONTINUE)},Question.loadQuestion=function(t){this.questionData=gSettings.question.questions[t],this.showLoadingMessage(),this.loadQuestionVo()},Question.showLoadingMessage=function(){null==this.loadingMessage?this.loadingMessage=this.baseScene.addText(gSettings.question.loadingText,this):this.loadingMessage.visible=!0},Question.hideLoadingMessage=function(){null!=this.loadingMessage&&(this.loadingMessage.visible=!1)},Question.loadQuestionVo=function(){this.load.setPath(gSettings.question.questionAudioPath);var t="question"+this.questionData.id;this.load.audio(t,this.questionData.questionVo),this.load.once("complete",this.handleQuestionVoLoaded,this),this.load.start()},Question.handleQuestionVoLoaded=function(){this.loadRemediationVo(),this.hideLoadingMessage(),this.showQuestion(),this.time.delayedCall(250,function(){this.sound.play("question"+this.questionData.id)},[],this)},Question.loadRemediationVo=function(){this.load.setPath(gSettings.question.questionAudioPath);for(var t=[],e=0;e<this.questionData.remediationVo.length;e++)t.push({key:"remediation"+this.questionData.id+"-"+e,url:this.questionData.remediationVo[e]});this.load.audio(t),this.load.once("complete",this.remediationVoLoaded,this),this.load.start()},Question.remediationVoLoaded=function(t,e,i){},Question.playRemediationVo=function(t){this.sound.stopAll();var e=.25;this.isCorrect&&(e=gSettings.sounds.questionCorrectDelay,this.baseScene.playSfx(gSettings.sounds.questionCorrect)),this.sound.play("remediation"+this.questionData.id+"-"+t,{delay:e})},Question.showQuestion=function(){this.questionText=this.baseScene.addText(gSettings.question.questionText,this),this.questionText.text=this.questionData.question;this.questionText.y,this.questionText.height,gSettings.question.optionText.ySpacing;for(var t=0;t<this.questionData.options.length;t++){this.options.push({text:null,button:null});var e=gSettings.question.optionButton.y+t*gSettings.question.optionButton.yInterval,i=this.baseScene.addText(gSettings.question.optionText,this);gSettings.enableCheat&&this.questionData.correctIndex==t?i.text="*"+this.questionData.options[t]:i.text=this.questionData.options[t],i.y=e,this.options[t].text=i;var s=new TextButton(gSettings.question.optionButton,this,this.handleOptionClick);s.setY(e),s.setText("ABCDEFG".charAt(t)),this.options[t].button=s,i.y,i.height,gSettings.question.optionText.ySpacing}},Question.handleOptionClick=function(t){for(var e=0,i=0;i<this.options.length;i++)if(this.options[i].button==t){e=i;break}t.showSelected(),this.disableOptions(),this.evaluate(e),this.showRemediation(e),this.playRemediationVo(e)},Question.disableOptions=function(){for(var t=0;t<this.options.length;t++)this.options[t].button.disable(!1)},Question.showRemediation=function(t){this.remediationText=this.baseScene.addText(gSettings.question.remediationText,this),this.remediationText.text=this.questionData.remediations[t],this.continueButton.setVisible(!0)},Question.evaluate=function(t){this.questionData.correctIndex==t?(this.isCorrect=!0,this.events.emit(this.CORRECT_ANSWER)):(this.isCorrect=!1,this.events.emit(this.INCORRECT_ANSWER))},Question.cleanUp=function(){this.sound.stopAll(),this.questionText.destroy();for(var t=0;t<this.options.length;t++)this.options[t].text.destroy(),this.options[t].button.destroy();this.options=[],this.continueButton.setVisible(!1),this.remediationText.destroy()},Question.handleCorrectClick=function(){this.isCorrect=!0,this.events.emit(this.CORRECT)},Question.handleIncorrectClick=function(){this.isCorrect=!1,this.events.emit(this.INCORRECT)};var Splash=new Phaser.Scene("Splash");Splash.CONTINUE="continue",Splash.init=function(){},Splash.preload=function(){},Splash.create=function(){this.baseScene=this.scene.get("GameBase"),this.baseScene.addBackgroundItems(gSettings.splash.backgroundItems,this),new TextButton(gSettings.splash.beginButton,this,this.handleBeginClick)},Splash.handleBeginClick=function(){this.events.emit(this.CONTINUE)};var Status=new Phaser.Scene("Status");Status.ALL_ITEMS_COLLECTED="all-items-collected",Status.init=function(){this.itemsCollected=0,this.itemImages=[]},Status.preload=function(){},Status.create=function(){this.baseScene=this.scene.get("GameBase"),this.baseScene.addImage(gSettings.status.background,this)},Status.earnItem=function(e){var i=null;for(let t=0;t<gSettings.status.locations.length;t++)if(gSettings.status.locations[t].id==e){i=gSettings.status.locations[t];break}var t=this.baseScene.addImage(i.image,this);this.itemImages.push(t);this.tweens.add({targets:t,scale:.09,x:i.point.x,y:i.point.y,ease:"sine.easeIn",duration:1e3,delay:500,onComplete:this.logCollectedItem,onCompleteScope:this})},Status.logCollectedItem=function(){this.itemsCollected++,this.allItemsCollected()&&this.events.emit(this.ALL_ITEMS_COLLECTED)},Status.allItemsCollected=function(){return this.itemsCollected==gSettings.map.items.length},Status.resetStatus=function(){for(let t=0;t<this.itemImages.length;t++)this.itemImages[t].destroy();this.itemImages=[],this.itemsCollected=0};var Win=new Phaser.Scene("Win");Map.PLAY_AGAIN="play-again",Win.init=function(){this.baseScene=null},Win.preload=function(){},Win.create=function(){this.baseScene=this.scene.get("GameBase");var t=this.add.graphics();t.fillStyle(16777215,.5),t.fillRect(0,0,800,600),this.baseScene.addImage(gSettings.win.box,this),this.baseScene.addText(gSettings.win.text,this),new TextButton(gSettings.win.playAgainButton,this,this.handlePlayAgainClick),this.events.on("wake",this.playVo,this),this.playVo()},Win.handlePlayAgainClick=function(){this.events.emit(this.PLAY_AGAIN),this.stopVo()},Win.playVo=function(){this.baseScene.playVo(gSettings.win.vo,null,null)},Win.stopVo=function(){this.baseScene.stopVo()},gSettings={scormEnabled:!1,autoScale:!0,enableCheat:!1,randomizeQuestions:!0,gameConfig:{width:800,height:600,backgroundColor:8422021},spritesheets:[{key:"main",atlasURL:"images/main.json",path:"images"}],voSprite:{key:"vo",jsonURL:"audio/vo.json",audioURL:["audio/vo.m4a","audio/vo.ogg"]},sfxSprite:{key:"sfx",jsonURL:"audio/sfx.json",audioURL:["audio/sfx.m4a","audio/sfx.ogg"]},loopSprite:{key:"loop",jsonURL:"audio/loops.json",audioURL:["audio/loops.m4a","audio/loops.ogg"]},loader:{rotator:{key:"rotator",file:"images/rotator.png",x:400,y:360,rotationDuration:2e3},backgroundElements:[{x:400,y:250,key:"logo",file:"images/logo.png"}],loadingText:{text:"Loading...",x:400,y:423,origin:{x:.5,y:.5},style:{fontFamily:"Arial, Helvetica, sans",fontSize:36,fontStyle:"700",color:"#fff"}},clickthroughText:{text:"Tap or click here to continue.",x:400,y:423,origin:{x:.5,y:.5},style:{fontFamily:"Arial, Helvetica, sans",fontSize:36,fontStyle:"700",color:"#fff"}}},splash:{backgroundItems:[{type:"image",x:400,y:300,texture:"main",frame:"splash-bg.png"}],beginButton:{x:630,y:490,graphic:{texture:"main",up:"play-up.png",over:"play-down.png",down:"play-down.png"}}},map:{backgroundItems:[{type:"image",x:400,y:300,texture:"main",frame:"map-bg.png"},{type:"image",x:188,y:163,texture:"main",frame:"stopsign-back.png"},{type:"image",x:461,y:178,texture:"main",frame:"stoplight-back.png"},{type:"image",x:461,y:408,texture:"main",frame:"stoplight-back.png"},{type:"image",x:596,y:45,texture:"main",frame:"stoplight.png"},{type:"image",x:594,y:265,texture:"main",frame:"stoplight.png"},{type:"image",x:232,y:541,texture:"main",frame:"stopsign.png"},{type:"image",x:583,y:536,texture:"main",frame:"stopsign.png"}],locations:[{id:"0",type:"start",point:{x:347,y:517},up:null,right:{path:["4"],question:!1},down:null,left:{path:["3"],question:!1}},{id:"1",type:"passthrough",point:{x:11,y:517}},{id:"2",type:"stop",point:{x:146,y:517},up:{path:["7"],question:!0},right:{path:["3"],question:!0},down:null,left:{path:["1","15","16"],question:!1}},{id:"3",type:"stop",point:{x:244,y:517},up:null,right:{path:["4"],question:!1},down:null,left:{path:["2"],question:!0}},{id:"4",type:"stop",point:{x:449,y:517},up:null,right:{path:["5"],question:!0},down:null,left:{path:["3"],question:!1}},{id:"5",type:"stop",point:{x:592,y:517},up:{path:["13"],question:!1},right:null,down:null,left:{path:["4"],question:!0}},{id:"6",type:"passthrough",point:{x:99,y:430}},{id:"7",type:"stop",point:{x:146,y:430},up:null,right:{path:["8","12"],question:!1},down:{path:["2"],question:!0},left:{path:["6","9","10"],question:!1}},{id:"8",type:"passthrough",point:{x:452,y:430}},{id:"9",type:"passthrough",point:{x:99,y:286}},{id:"10",type:"stop",point:{x:172,y:286},up:{path:["16"],question:!0},right:{path:["11"],question:!1},down:null,left:{path:["9","6","7"],question:!1}},{id:"11",type:"stop",point:{x:361,y:286},up:{path:["18"],question:!0},right:{path:["12"],question:!1},down:null,left:{path:["10"],question:!1}},{id:"12",type:"stop",point:{x:452,y:286},up:null,right:{path:["13"],question:!0},down:{path:["8","7"],question:!1},left:{path:["11"],question:!1}},{id:"13",type:"stop",point:{x:592,y:286},up:null,right:{path:["14"],question:!1},down:{path:["5"],question:!1},left:{path:["12"],question:!0}},{id:"14",type:"stop",point:{x:774,y:286},up:{path:["21"],question:!0},right:null,down:null,left:{path:["13"],question:!1}},{id:"15",type:"passthrough",point:{x:11,y:200}},{id:"16",type:"stop",point:{x:172,y:200},up:{path:["22"],question:!1},right:null,down:{path:["10"],question:!0},left:{path:["15","1","2"],question:!1}},{id:"17",type:"passthrough",point:{x:272,y:200}},{id:"18",type:"stop",point:{x:361,y:200},up:null,right:{path:["19","24"],question:!1},down:{path:["11"],question:!0},left:{path:["17","23"],question:!1}},{id:"19",type:"passthrough",point:{x:452,y:200}},{id:"20",type:"passthrough",point:{x:592,y:200}},{id:"21",type:"stop",point:{x:774,y:200},up:{path:["26","25"],question:!1},right:null,down:{path:["14"],question:!0},left:{path:["20","25"],question:!1}},{id:"22",type:"stop",point:{x:172,y:67},up:null,right:{path:["23"],question:!0},down:{path:["16"],question:!1},left:null},{id:"23",type:"stop",point:{x:272,y:67},up:null,right:{path:["24"],question:!1},down:{path:["17","18"],question:!1},left:{path:["22"],question:!0}},{id:"24",type:"stop",point:{x:452,y:67},up:null,right:{path:["25"],question:!0},down:{path:["19","18"],question:!1},left:{path:["23"],question:!1}},{id:"25",type:"stop",point:{x:592,y:67},up:null,right:{path:["26","21"],question:!1},down:{path:["20","21"],question:!1},left:{path:["24"],question:!0}},{id:"26",type:"passthrough",point:{x:774,y:67}}],itemLocations:[{region:"west",points:[{x:46,y:517},{x:13,y:357},{x:85,y:204},{x:175,y:118}]},{region:"center",points:[{x:96,y:378},{x:276,y:285},{x:455,y:344},{x:321,y:432}]},{region:"north",points:[{x:270,y:150},{x:360,y:65},{x:454,y:144}]},{region:"northeast",points:[{x:591,y:150},{x:683,y:65},{x:775,y:115},{x:683,y:204}]},{region:"east",points:[{x:591,y:399},{x:683,y:285}]}],items:[{id:"hat",image:{x:0,y:0,texture:"main",frame:"item-hat.png"},messageId:"hat-collected"},{id:"vest",image:{x:0,y:0,texture:"main",frame:"item-vest.png"},messageId:"vest-collected"},{id:"whistle",image:{x:0,y:0,texture:"main",frame:"item-whistle.png"},messageId:"whistle-collected"},{id:"stopsign",image:{x:0,y:0,texture:"main",frame:"item-stopsign.png"},messageId:"stop-sign-collected"}],player:{image:{x:350,y:513,texture:"main",frame:"player-down.png",origin:{x:.5,y:.8}},up:{texture:"main",frame:"player-up.png"},right:{texture:"main",frame:"player-right.png"},down:{texture:"main",frame:"player-down.png"},left:{texture:"main",frame:"player-left.png"},startDirectionOptions:{up:!1,right:!0,down:!1,left:!0},speed:100},goal:{image:{x:0,y:0,texture:"main",frame:"guard-plain.png",origin:{x:.4,y:.8}},winFrame:"guard-adorned.png"},crosswalkClosed:{image:{x:0,y:0,texture:"main",frame:"dontwalk.png"},upOffset:45,rightOffset:37,downOffset:40,leftOffset:37},upButton:{x:0,y:-45,graphic:{texture:"main",up:"arrowup-up.png",over:"arrowup-down.png",down:"arrowup-down.png"}},rightButton:{x:30,y:0,graphic:{texture:"main",up:"arrowright-up.png",over:"arrowright-down.png",down:"arrowright-down.png"}},downButton:{x:0,y:30,graphic:{texture:"main",up:"arrowdown-up.png",over:"arrowdown-down.png",down:"arrowdown-down.png"}},leftButton:{x:-30,y:0,graphic:{texture:"main",up:"arrowleft-up.png",over:"arrowleft-down.png",down:"arrowleft-down.png"}}},status:{background:{x:700,y:575,texture:"main",frame:"status-bg.png"},locations:[{id:"hat",image:{x:400,y:300,texture:"main",frame:"hat-big.png"},point:{x:623,y:572},scaleTo:.09},{id:"vest",image:{x:400,y:300,texture:"main",frame:"vest-big.png"},point:{x:723,y:572},scaleTo:.09},{id:"whistle",image:{x:400,y:300,texture:"main",frame:"whistle-big.png"},point:{x:771,y:571},scaleTo:.09},{id:"stopsign",image:{x:400,y:300,texture:"main",frame:"stopsign-big.png"},point:{x:673,y:570},scaleTo:.09}]},dialog:{box:{x:400,y:25,texture:"main",frame:"dialog-bg.png"},closePositionOffset:{x:0,y:-60},closeButton:{x:775,y:24,graphic:{texture:"main",up:"dialog x btn.png",over:"dialog x btn.png",down:"dialog x btn.png",disabled:"dialog x btn.png"}},replayButton:{x:745,y:24,graphic:{texture:"main",up:"dialog replay btn.png",over:"dialog replay btn.png",down:"dialog replay btn.png",disabled:"dialog replay btn.png"}},text:{text:"-",x:400,y:24,origin:{x:.5,y:.55},style:{fontFamily:"Mukta, Arial, Helvetica, sans",fontSize:17,color:"#fff",align:"center",fontStyle:"700",wordWrap:{width:650}}},openAnimation:{duration:300,ease:"Sine.easeIn"},closeAnimation:{duration:500,ease:"Sine.easeOut"},pointer:{x:0,y:0,texture:"main",frame:"pointer.png"},messages:[{id:"instructions",text:"The crossing guard has misplaced her hat, vest, whistle, and stop sign.\nYour mission is to find them and bring them to her.",showCloseButton:!1,showReplayButton:!1,pointers:[],vo:{key:"vo",sprite:"Instructions 1",config:{}},nextMessage:"instructions2"},{id:"instructions2",text:"Each time you try to cross a street you will be asked a question about pedestrian safety. If you answer incorrectly you won’t be allowed to cross.",showCloseButton:!1,showReplayButton:!1,pointers:[],vo:{key:"vo",sprite:"Instructions 2",config:{}},nextMessage:"instructions3"},{id:"instructions3",text:"To get started, click on one of the arrows to choose the direction you’d like to go first.",showCloseButton:!1,showReplayButton:!1,pointers:[{x:254,y:526,flipHorizontal:!1}],vo:{key:"vo",sprite:"Instructions 3",config:{}},nextMessage:null},{id:"question-prompt",text:"Answer the following question correctly to cross the street.",showCloseButton:!1,showReplayButton:!1,pointer:[],vo:{key:"vo",sprite:"Question prompt",config:{}},nextMessage:null},{id:"all-items-collected",text:"You now have all of the crossing guard’s missing items. Complete your mission by returning them to her.",showCloseButton:!1,showReplayButton:!1,pointer:[],vo:{key:"vo",sprite:"All found",config:{}},nextMessage:null},{id:"hat-collected",text:"You found the crossing guard’s hat!",showCloseButton:!1,showReplayButton:!1,pointer:[],vo:{key:"vo",sprite:"Hat found",config:{}},nextMessage:null},{id:"whistle-collected",text:"You found the crossing guard’s whistle!",showCloseButton:!1,showReplayButton:!1,pointer:[],vo:{key:"vo",sprite:"Whistle found",config:{}},nextMessage:null},{id:"vest-collected",text:"You found the crossing guard’s vest!",showCloseButton:!1,showReplayButton:!1,pointer:[],vo:{key:"vo",sprite:"Vest found",config:{}},nextMessage:null},{id:"stop-sign-collected",text:"You found the crossing guard’s stop sign!",showCloseButton:!1,showReplayButton:!1,pointer:[],vo:{key:"vo",sprite:"Stop sign found",config:{}},nextMessage:null}]},win:{box:{x:400,y:300,texture:"main",frame:"win-bg.png"},text:{text:"Great job! You found all of the crossing guard’s items and returned them to her by using your knowledge of pedestrian safety. Now she can help kids like you cross the street safely. Way to go!",x:400,y:120,origin:{x:.5,y:0},style:{fontFamily:"Mukta, Arial, Helvetica, sans",fontSize:26,color:"#397D3C",align:"center",wordWrap:{width:500}}},playAgainButton:{x:400,y:400,graphic:{texture:"main",up:"playagainbutton-up.png",over:"playagainbutton-down.png",down:"playagainbutton-down.png"}},vo:{key:"vo",sprite:"Win",config:{}}},question:{backgroundItems:[{type:"image",x:400,y:300,texture:"main",frame:"question-bg.png"}],loadingText:{text:"loading...",x:400,y:300,origin:{x:.5,y:.5},style:{fontFamily:"Mukta, Arial, Helvetica, sans",fontSize:28,color:"#397D3C",fontStyle:"700",align:"center"}},questionText:{text:"",x:400,y:114,origin:{x:.5,y:.5},style:{fontFamily:"Mukta, Arial, Helvetica, sans",fontSize:30,color:"#E6E7E8",fontStyle:"700",align:"center",wordWrap:{width:600}}},optionText:{text:"",x:180,y:0,origin:{x:0,y:.5},style:{fontFamily:"Mukta, Arial, Helvetica, sans",fontSize:20,color:"#367d3c",fontStyle:"700",align:"left",wordWrap:{width:550}}},remediationText:{text:"",x:400,y:460,origin:{x:.5,y:0},style:{fontFamily:"Mukta, Arial, Helvetica, sans",fontSize:20,color:"#E6E7E8",fontStyle:"700",align:"center",wordWrap:{width:650}}},continueButton:{x:400,y:541,graphic:{texture:"main",up:"continuebutton-up.png",over:"continuebutton-down.png",down:"continuebutton-down.png"}},optionButton:{x:130,y:233,yInterval:70,graphic:{texture:"main",up:"optionbutton-up.png",over:"optionbutton-down.png",down:"optionbutton-down.png",selected:"optionbutton-down.png"},text:{xOffset:-2,yOffset:-2,label:"A",upStyle:{fontFamily:"Mukta, Arial, Helvetica, sans",fontSize:32,color:"#E6E7E8",fontStyle:"700"},overStyle:{fontFamily:"Mukta, Arial, Helvetica, sans",fontSize:32,color:"#E6E7E8",fontStyle:"700"},downStyle:{fontFamily:"Mukta, Arial, Helvetica, sans",fontSize:32,color:"#E6E7E8",fontStyle:"700"}},hitArea:{type:"rect",x:0,y:0,width:580,height:60}},questionAudioPath:"audio/questions/",questions:[{id:"1",question:"What is a pedestrian?",options:["A person who is driving a car","A person who is walking","A person who is riding a bike"],remediations:["Nope. A pedestrian is someone who is walking.","You got it!","Nope. A pedestrian is someone who is walking."],correctIndex:1,questionVo:["Question 1.m4a","Question 1.ogg"],remediationVo:[["1ac remediation.m4a","1ac remediation.ogg"],["1b remediation.m4a","1b remediation.ogg"],["1ac remediation.m4a","1ac remediation.ogg"]]},{id:"2",question:"Which of the following is true about a crosswalk?",options:["A crosswalk shows pedestrians where to cross the street.","A crosswalk is a place in the street to stop and talk with your friends.","A crosswalk is a marked lane in the street for motorcycles to drive in."],remediations:["Correct!","No way! A crosswalk shows pedestrians where to cross the street.","No way! A crosswalk shows pedestrians where to cross the street."],correctIndex:0,questionVo:["Question 2.m4a","Question 2.ogg"],remediationVo:[["2a remediation.m4a","2a remediation.ogg"],["2bc remediation.m4a","2bc remediation.ogg"],["2bc remediation.m4a","2bc remediation.ogg"]]},{id:"3",question:"Before crossing the street you should make eye contact with drivers in stopped vehicles.",options:["True","False"],remediations:["That's right!","Actually, that's true. You should make eye contact with drivers in stopped vehicles before crossing."],correctIndex:0,questionVo:["Question 3.m4a","Question 3.ogg"],remediationVo:[["3a remediation.m4a","3a remediation.ogg"],["3b remediation.m4a","3b remediation.ogg"]]},{id:"4",question:"How do traffic signals, like stoplights and stop signs, make it safer for you to cross the street?",options:["They tell drivers when there is a biker in the bike lane.","They tell drivers to stop.","They tell drivers what the speed limit is."],remediations:["That's incorrect. Traffic signals tell drivers to stop so you can safely cross.","Correct!","That's incorrect. Traffic signals tell drivers to stop so you can safely cross."],correctIndex:1,questionVo:["Question 4.m4a","Question 4.ogg"],remediationVo:[["4ac remediation.m4a","4ac remediation.ogg"],["4b remediation.m4a","4b remediation.ogg"],["4ac remediation.m4a","4ac remediation.ogg"]]},{id:"5",question:"Kids under the age of 10 should only cross the street with an adult.",options:["True","False"],remediations:["You're right!","Actually, that's true. You should cross the street with an adult until you are at least 10."],correctIndex:0,questionVo:["Question 5.m4a","Question 5.ogg"],remediationVo:[["5a remediation.m4a","5a remediation.ogg"],["5b remediation.m4a","5b remediation.ogg"]]},{id:"6",question:"Do crosswalks all look the same?",options:["Yes","No"],remediations:["Not quite. Crosswalks can look different in different communities.","That's right. Crosswalks can look different in different communities."],correctIndex:1,questionVo:["Question 6.m4a","Question 6.ogg"],remediationVo:[["6a remediation.m4a","6a remediation.ogg"],["6b remediation.m4a","6b remediation.ogg"]]},{id:"7",question:"Sometimes it's ok to run across the street.",options:["True","False"],remediations:["No way! It's never safe to run across the street.","That's right. It's never safe to run across the street."],correctIndex:1,questionVo:["Question 7.m4a","Question 7.ogg"],remediationVo:[["7a remediation.m4a","7a remediation.ogg"],["7b remediation.m4a","7b remediation.ogg"]]},{id:"8",question:"Which of these tell drivers what to do?",options:["Stoplights and stop signs","Pedestrian signals","Yard signs"],remediations:["Correct!","Incorrect. Stoplights and stop signs tell drivers what to do.","Incorrect. Stoplights and stop signs tell drivers what to do."],correctIndex:0,questionVo:["Question 8.m4a","Question 8.ogg"],remediationVo:[["8a remediation.m4a","8a remediation.ogg"],["8bc remediation.m4a","8bc remediation.ogg"],["8bc remediation.m4a","8bc remediation.ogg"]]},{id:"9",question:"What three things should you do before crossing the street?",options:["Stop, jump, and look.","Pause, listen, and smell.","Stop, look, and listen."],remediations:["Not quite. You should stop, look, and listen before crossing the street.","Not quite. You should stop, look, and listen before crossing the street.","That's right!"],correctIndex:2,questionVo:["Question 9.m4a","Question 9.ogg"],remediationVo:[["9ab remediation.m4a","9ab remediation.ogg"],["9ab remediation.m4a","9ab remediation.ogg"],["9c remediation.m4a","9c remediation.ogg"]]},{id:"10",question:"What is a median?",options:["A place for pedestrians to wait halfway through crossing until the pedestrian walk signal comes on again","A place for vehicles to wait for a train to pass by","A marked lane for pedestrians to walk in while crossing busy intersections"],remediations:["That's right!","Nope. A median is a place for pedestrians to wait halfway through crossing until the pedestrian walk signal comes on again.","Nope. A median is a place for pedestrians to wait halfway through crossing until the pedestrian walk signal comes on again."],correctIndex:0,questionVo:["Question 10.m4a","Question 10.ogg"],remediationVo:[["10a remediation.m4a","10a remediation.ogg"],["10bc remediation.m4a","10bc remediation.ogg"],["10bc remediation.m4a","10bc remediation.ogg"]]},{id:"11",question:"Why should you only cross the street with an adult until you are 10 years old?",options:["Because your legs are still growing and they don't move as fast as an adult's legs","Because adults often need help crossing","Because your brain is still growing and it's hard to tell how fast cars are going"],remediations:["That's incorrect. You should cross with an adult until age 10 because your brain is still growing and it's hard to tell how fast cars are going.","That's incorrect. You should cross with an adult until age 10 because your brain is still growing and it's hard to tell how fast cars are going.","That's right!"],correctIndex:2,questionVo:["Question 11.m4a","Question 11.ogg"],remediationVo:[["11ab remediation.m4a","11ab remediation.ogg"],["11ab remediation.m4a","11ab remediation.ogg"],["11c remediation.m4a","11c remediation.ogg"]]},{id:"12",question:"Is it safe to cross in the middle of the street if it's the quickest route to where you are going?",options:["Yes","No"],remediations:["That's incorrect. It's not safe to cross in the middle of the street because there's nothing slowing cars down and they may not see you.","That's right!  It's not safe to cross in the middle of the street because there's nothing slowing cars down and they may not see you."],correctIndex:1,questionVo:["Question 12.m4a","Question 12.ogg"],remediationVo:[["12a remediation.m4a","12a remediation.ogg"],["12b remediation.m4a","12b remediation.ogg"]]},{id:"13",question:"When the pedestrian light is flashing red and the timer is running low, what should you do?",options:["Start walking across the street.","Run across the street.","Wait for the next walk signal."],remediations:["Nope. You should wait for the next walk signal.","Nope. You should wait for the next walk signal.","You're right!"],correctIndex:2,questionVo:["Question 13.m4a","Question 13.ogg"],remediationVo:[["13ab remediation.m4a","13ab remediation.ogg"],["13ab remediation.m4a","13ab remediation.ogg"],["13c remediation.m4a","13c remediation.ogg"]]},{id:"14",question:"Which of these would be the safer place to cross the street?",options:["From corner to corner with a marked crosswalk and stoplights","From corner to corner with no marked crosswalk or stoplights","The middle of the block"],remediations:["That's right!","Not quite. Crossing from corner to corner with a marked crosswalk and stoplights would be safer.","Not quite. Crossing from corner to corner with a marked crosswalk and stoplights would be safer."],correctIndex:0,questionVo:["Question 14.m4a","Question 14.ogg"],remediationVo:[["14a remediation.m4a","14a remediation.ogg"],["14bc remediation.m4a","14bc remediation.ogg"],["14bc remediation.m4a","14bc remediation.ogg"]]},{id:"15",question:"Since pedestrians have the right of way at a crosswalk, you can assume that cars will stop for you to cross the street.",options:["True","False"],remediations:["Nope. Even though pedestrians have the right of way, you still need use caution when crossing the street.","That's correct. Even though pedestrians have the right of way, you still need to use caution when crossing the street."],correctIndex:1,questionVo:["Question 15.m4a","Question 15.ogg"],remediationVo:[["15a remediation.m4a","15a remediation.ogg"],["15b remediation.m4a","15b remediation.ogg"]]},{id:"16",question:"When crossing in a crosswalk, do you need to pay attention?",options:["Yes","No"],remediations:["Correct! Even though you are crossing in a crosswalk, you still need to pay attention to the traffic around you.","That's incorrect. Even though you are crossing in a crosswalk, you still need to pay attention to the traffic around you."],correctIndex:0,questionVo:["Question 16.m4a","Question 16.ogg"],remediationVo:[["16a remediation.m4a","16a remediation.ogg"],["16b remediation.m4a","16b remediation.ogg"]]}]},sounds:{musicLoop:{key:"loop",sprite:"bass loop",config:{loop:!0}},questionPrompt:{key:"sfx",sprite:"question prompt",config:{}},questionCorrectDelay:.75,questionCorrect:{key:"sfx",sprite:"question correct",config:{}},itemPickup:{key:"sfx",sprite:"item pickup",config:{}},dontWalk:{key:"sfx",sprite:"dont walk",config:{}},win:{key:"sfx",sprite:"win",config:{}},walkLoop:{key:"loop",sprite:"walk loop",config:{loop:!0,volume:.6}}}};